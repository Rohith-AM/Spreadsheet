<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexora Modular Spreadsheet</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    <div id="app-container">
        <div id="toolbar">
            <div class="group">
                <button onclick="Tools.toggleBold()"><b>B</b></button>
                <button onclick="Tools.toggleItalic()"><i>I</i></button>
                <button onclick="Tools.downloadCSV()">Download</button>
            </div>
            <div class="group">
                <button onclick="GraphTool.createGraph()">Insert Graph</button>
            </div>
            <div class="formula-group">
                <span>fx:</span>
                <input type="text" id="formula-input" placeholder="Enter formula...">
            </div>
        </div>

        <div id="grid-container" onscroll="VirtualScroll.onScroll(event)">
            <div id="scroll-spacer"></div>
            <div id="cells-layer"></div>
        </div>

        <div id="graph-modal" class="hidden">
            <div class="modal-content">
                <span class="close" onclick="GraphTool.closeGraph()">&times;</span>
                <canvas id="chartCanvas"></canvas>
            </div>
        </div>
    </div>

    <script>
        // Global State accessible by all files
        const State = {
            data: {},     // Stores values: { "A1": "10", "B1": "=A1*2" }
            styles: {},   // Stores styles: { "A1": "bold" }
            config: {
                rows: 1000,
                cols: 26, // A-Z
                rowHeight: 30,
                colWidth: 100
            }
        };
    </script>

    <script src="formulas.js"></script>
    <script src="graphs.js"></script>
    <script src="tools.js"></script>
    <script src="virtual_scroll.js"></script>

    <script>
        // Start the engine once DOM is ready
        window.onload = () => {
            VirtualScroll.init();
            console.log("Nexora Spreadsheet Loaded.");
        };
    </script>

</body>
</html>
