<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexora Spreadsheet Platform</title>
    
    <link rel="stylesheet" href="style.css">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

    <div id="app-container">
        
        <div id="toolbar">
            <div class="group">
                <button onclick="StorageEngine.saveToLocal()" title="Save (Ctrl+S)">ğŸ’¾</button>
                <button onclick="StorageEngine.clearData()" title="Reset Sheet">ğŸ—‘ï¸</button>
            </div>

            <div class="group">
                <button onclick="StorageEngine.downloadCSV()" title="Export CSV">.CSV</button>
                <button onclick="StorageEngine.downloadPDF()" title="Export PDF" style="color:#d93025">.PDF</button>
                <button onclick="StorageEngine.downloadJSON()" title="Backup">.JSON</button>
            </div>

            <div class="group">
                <button onclick="Formatting.toggleBold()" title="Bold"><b>B</b></button>
                <button onclick="Formatting.toggleItalic()" title="Italic"><i>I</i></button>
                <button onclick="Formatting.applyStyle('textAlign', 'left')">â‡¤</button>
                <button onclick="Formatting.applyStyle('textAlign', 'center')">â‡¹</button>
                <button onclick="Formatting.applyStyle('textAlign', 'right')">â‡¥</button>
            </div>

            <div class="group">
                <button onclick="Formatting.applyStyle('color', 'red')" style="color:red">A</button>
                <button onclick="Formatting.applyStyle('color', 'blue')" style="color:blue">A</button>
                <button onclick="Formatting.applyStyle('backgroundColor', 'yellow')" style="background:yellow; padding:0 8px;">&nbsp;</button>
                <button onclick="Formatting.applyStyle('backgroundColor', 'transparent')" title="Clear Fill">ğŸš«</button>
            </div>

            <div class="group">
                <button onclick="GraphTool.createGraph()">ğŸ“Š Graph</button>
            </div>
        </div>

        <div class="formula-wrapper">
            <div class="fx-icon">fx</div>
            <input type="text" id="formula-input" placeholder="Type a value or formula (e.g. =SUM(A1:A5))">
        </div>

        <div id="grid-container">
            <div id="header-row-container"></div> 
            
            <div id="scroll-spacer"></div>
            
            <div id="cells-layer"></div>
        </div>
    </div>

    <div id="graph-modal" class="hidden">
        <div class="modal-content">
            <span class="close" onclick="GraphTool.closeGraph()">&times;</span>
            <canvas id="chartCanvas"></canvas>
        </div>
    </div>

    <script src="core.js"></script>
    <script src="formula_library.js"></script>

    <script src="storage_export.js"></script>
    <script src="formatting.js"></script>
    <script src="graphs.js"></script>

    <script src="grid_renderer.js"></script>
    <script src="events.js"></script>
    <script src="context_menu.js"></script>

    <script>
        window.onload = function() {
            console.log("ğŸš€ Nexora Platform Launching...");
            
            // Initialize in specific order
            Core.init();
            StorageEngine.init();
            Renderer.init();
            Events.init();
            ContextMenu.init();

            console.log("âœ… System Online.");
        };
    </script>

</body>
</html>
